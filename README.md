# Тестовое задание URSiP с описанием решения
## Задание
Создать парсер excel файла (во вложении) на Python.

Создать таблицу согласно нормам реляционных баз данных (внести все значения в одну таблицу)

Добавить расчетный тотал по Qoil, Qliq, сгруппированный по датам (даты можете указать свои,
добавив программно, не изменяя исходный файл, при условии, что дни будут разные, а месяц и год одинаковые)

1. Результат должен представлять готовое к использованию решение
2. Результат для проверки разместить на Github, предоставить ссылку
3. Просьба показать понимание принципов SOLID и  практик связанных с этими принципами
4. В качестве БД можете использовать любую, например SQLite
5. Тестовое задание не ограничено по времени, можете взять несколько дней

## Решение
Дизайн решения создавал с учетом возможностей легкого расширения и внесения изменений,
то есть меньших по времени и сложности трудозатрат.

Модуль управления services зависит от структуры данных и базы данных,
но поток управления идет от модуля управления - так реализован принцип инверсии зависимости.

Модуль работы с хранением не зависит от модуля аналитики, что позволяет изменить реализацию модуля,
но эти изменения не будут затрагивать изменения в другом. Здесь применен принцип единой ответственности.

Хранилища могут быть разные (Excel, SQLite3, PostgreSQL и т.д.), но используют единый интерфейс
для CRUD операций. Это позволяет, например, осуществить сохранение в цикле в разные хранилища единым способом, 
просто итерируя их. Нам не важно как в конкретном хранилище это делается - в этом месте пример реализации 
принципа подстановки Барбары Лисков.

В хранилище также реализован принцип открытости-закрытости в иерархии компонентов. 
Мы легко можем добавить Panda в парсеры или локально изменить алгоритм парсинга с единственной обязанностью 
реализации интерфеса ExcelParserInterface с методом get_table, который вызывается из модуля более высокого уровня ExcelStorage.

Избавление от неиспользуемого функционала реализовано в сущностях с использованием примесей. Таким образом 
создан объект Measurements, не содержащий поля name, а Companies содержит его, благодаря примеси EntityNameMixin.
Та же ситуация с хранилищем, где примесь DBStorageMixin расширяет DBStorageInterface методом _get_db_settings, 
который не нужен для ExcelStorage. Таким образом реализован принцип разделения интерфейсов.

### Концептуальное описание моделей действий 
Приложение импортирует данные (Excel, какой-то БД или другой способ хранения), которые сохраняются 
в объекты и могут изменяться, анализироваться, выводиться и сохраняться в тот же источник данных или другой. 

Реализован ORM импорта из Excel и сохранение в БД SQLite3.

Анализ данных происходит на основании объектов, а не запросов выборки из БД. Объект отчета представляет из себя новый 
объект, который можно выводить на печать, сохранять и т.д. Реализован тестовый вывод в терминал.
Запросы по аналитической выборке и агрегации нарушили бы принцип единой ответственности, заставив, при внесении 
изменений в отчет, вносить изменения в разные компоненты или при изменении алгоритма доступа к хранилищу изменять 
компоненты, связанные с аналитическими отчетами.


#### Использование
1. Установить зависимости из файла requirements.txt
2. Запустить в CLI командой
```
python3 main.py
```

